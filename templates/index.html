<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rezervační systém v3.2</title>
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header class="header">
        <h1>Rezervační systém</h1>
        <div class="header-actions">
            <!-- Navigační tlačítka pro kalendář -->
            <div class="calendar-navigation">
                <button id="prev-week-btn" class="btn btn-secondary" title="Předchozí týden">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                    </svg>
                </button>
                <button id="prev-3days-btn" class="btn btn-secondary" title="3 dny zpět">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
                    </svg>
                    3
                </button>
                <button id="today-btn" class="btn btn-primary" title="Dnešní datum">DNES</button>
                <button id="next-3days-btn" class="btn btn-secondary" title="3 dny vpřed">
                    3
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                </button>
                <button id="next-week-btn" class="btn btn-secondary" title="Další týden">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                </button>
            </div>
            
            <!-- Původní tlačítka -->
            <button id="add-equipment-button" class="btn btn-secondary">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                </svg>
                Nové zařízení
            </button>
            <button id="manage-projects-button" class="btn btn-secondary">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M9.828 3h3.982a2 2 0 0 1 1.992 2.181l-.637 7A2 2 0 0 1 13.174 14H2.825a2 2 0 0 1-1.991-1.819l-.637-7a1.99 1.99 0 0 1 .342-1.31L.5 3a2 2 0 0 1 2-2h3.672a2 2 0 0 1 1.414.586l.828.828A2 2 0 0 0 9.828 3zm-8.322.12C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707A1 1 0 0 0 6.172 2H2.5a1 1 0 0 0-1 .981l.006.139z"/>
                </svg>
                Správa projektů
            </button>
            <button id="add-test-button" class="btn btn-primary">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                </svg>
                Nový test
            </button>
        </div>
    </header>

    <main class="main-container">
        <div class="timeline-viewport">
            <div class="app-layout">
                <div id="equipment-sidebar" class="equipment-sidebar">
                </div>
                <div id="timeline-grid-wrapper" class="timeline-grid-wrapper">
                    <div id="timeline-grid" class="timeline-grid"></div>
                </div>
            </div>
        </div>
    </main>

    <div id="booking-modal" class="modal-overlay">
        <div class="modal-content booking-modal-content">
            <h2 id="modal-title">Nová rezervace</h2>
            <form id="booking-form">
                <input type="hidden" id="booking-id">
                
                <!-- Hlavní řádek: Číslo testu + Projekt -->
                <div class="form-row-grid">
                    <div class="form-group">
                        <label for="booking-eusuva">Číslo testu</label>
                        <div class="form-row-flex">
                            <span>EU-SVA-</span>
                            <input type="text" id="booking-eusuva" required pattern="\d{6}" maxlength="6" placeholder="xxxxxx" title="Zadejte 6 číslic">
                            <span id="eusuva-year">-25</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="booking-project">Projekt</label>
                        <div class="project-row">
                            <select id="booking-project-preset">
                                <option value="">Vyberte projekt</option>
                            </select>
                            <input type="text" id="booking-project" required placeholder="nebo zadejte vlastní">
                            <input type="color" id="booking-project-color" value="#4a90e2" title="Barva projektu">
                        </div>
                    </div>
                </div>

                <!-- Poznámka -->
                <div class="form-group">
                    <label for="booking-note">Poznámka k testu</label>
                    <input type="text" id="booking-note" placeholder="Volitelné vysvětlení o jaký test se jedná">
                </div>

                <!-- Zařízení řádek -->
                <div class="form-row-grid">
                    <div class="form-group">
                        <label for="booking-equip">Zařízení</label>
                        <select id="booking-equip" required></select>
                    </div>

                    <div class="form-group" id="equipment-side-container" style="display: none;">
                        <label for="booking-equipment-side">Strana zařízení</label>
                        <select id="booking-equipment-side">
                            <option value="A">Strana A</option>
                            <option value="B">Strana B</option>
                            <option value="both">Obě strany</option>
                        </select>
                    </div>
                    
                    <div class="form-group checkbox-group" id="both-spaces-container" style="display: none;">
                        <label>
                            <input type="checkbox" id="booking-both-spaces">
                            Zabrat oba prostory
                        </label>
                    </div>
                </div>

                <!-- Datum řádek -->
                <div class="form-row-grid">
                    <div class="form-group">
                        <label for="booking-start">Datum od</label>
                        <input type="date" id="booking-start" required>
                    </div>
                    <div class="form-group">
                        <label for="booking-end">Datum do</label>
                        <input type="date" id="booking-end" required>
                    </div>
                </div>

                <!-- Pokročilé nastavení -->
                <details class="advanced-settings">
                    <summary>Pokročilé nastavení zobrazení</summary>
                    
                    <div class="form-group">
                        <label for="booking-display-text">Vlastní text v kalendáři</label>
                        <textarea id="booking-display-text" placeholder="Nechte prázdné pro automatické generování" rows="2"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Styl textu</label>
                        <div class="text-style-controls">
                            <input type="color" id="booking-text-color" value="#ffffff" title="Barva textu">
                            <select id="booking-font-size">
                                <option value="12px">Malé</option>
                                <option value="14px" selected>Normální</option>
                                <option value="16px">Větší</option>
                            </select>
                            <label><input type="checkbox" id="booking-text-bold"> Tučné</label>
                            <label><input type="checkbox" id="booking-text-italic"> Kurzíva</label>
                        </div>
                    </div>
                </details>

                <div class="modal-buttons">
                    <button type="button" id="delete-button" class="btn btn-danger" style="margin-right: auto;">Smazat</button>
                    <button type="button" id="cancel-button" class="btn btn-secondary">Zrušit</button>
                    <button type="submit" class="btn btn-primary">Uložit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pro editaci zařízení -->
    <div id="equipment-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="equipment-modal-title">Upravit zařízení</h2>
            <form id="equipment-form">
                <input type="hidden" id="equipment-id">
                
                <div>
                    <label for="equipment-name">Název zařízení/strany</label>
                    <input type="text" id="equipment-name" required>
                </div>

                <div>
                    <label for="equipment-category">Kategorie</label>
                    <select id="equipment-category" required>
                        <option value="">Vyberte kategorii</option>
                        <option value="Climatic">Climatic</option>
                        <option value="Durability">Durability</option>
                        <option value="Measuring">Measuring</option>
                        <option value="Special Stand">Special Stand</option>
                    </select>
                </div>

                <div>
                    <label for="equipment-status">Stav zařízení</label>
                    <select id="equipment-status" required>
                        <option value="active">Aktivní (dostupné)</option>
                        <option value="out-of-order">Mimo provoz</option>
                    </select>
                </div>

                <div>
                    <label for="equipment-capacity">Kapacita (počet testů)</label>
                    <input type="number" id="equipment-capacity" min="0" max="10" required>
                </div>

                <div class="form-section" id="sides-section">
                    <h3>Správa stran/prostorů</h3>
                    <div id="sides-management">
                        <!-- Zde se zobrazí seznam všech stran daného zařízení -->
                    </div>
                    <button type="button" id="add-side-button" class="btn btn-secondary">Přidat stranu/prostor</button>
                </div>

                <div class="modal-buttons">
                    <button type="button" id="delete-equipment-button" class="btn btn-danger" style="margin-right: auto;">Smazat stranu</button>
                    <button type="button" id="cancel-equipment-button" class="btn btn-secondary">Zrušit</button>
                    <button type="submit" class="btn btn-primary">Uložit</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pro přidání nového zařízení -->
    <div id="new-equipment-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Přidat nové zařízení</h2>
            <form id="new-equipment-form">
                <div>
                    <label for="new-equipment-name">Název zařízení</label>
                    <input type="text" id="new-equipment-name" required placeholder="Např. Nová klimakomora">
                </div>

                <div>
                    <label for="new-equipment-category">Kategorie</label>
                    <select id="new-equipment-category" required>
                        <option value="">Vyberte kategorii</option>
                        <option value="Climatic">Climatic</option>
                        <option value="Durability">Durability</option>
                        <option value="Measuring">Measuring</option>
                        <option value="Special Stand">Special Stand</option>
                    </select>
                </div>

                <div>
                    <label for="new-equipment-status">Stav zařízení</label>
                    <select id="new-equipment-status" required>
                        <option value="active">Aktivní (dostupné)</option>
                        <option value="out-of-order">Mimo provoz</option>
                    </select>
                </div>

                <div>
                    <label for="new-equipment-capacity">Kapacita (počet testů)</label>
                    <input type="number" id="new-equipment-capacity" min="1" max="10" value="1" required>
                </div>

                <div>
                    <label for="new-equipment-sides">Počet stran/prostorů</label>
                    <input type="number" id="new-equipment-sides" min="1" max="4" value="1" required>
                </div>

                <div class="modal-buttons">
                    <button type="button" id="cancel-new-equipment-button" class="btn btn-secondary">Zrušit</button>
                    <button type="submit" class="btn btn-primary">Přidat zařízení</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pro správu projektů -->
    <div id="projects-modal" class="modal-overlay">
        <div class="modal-content projects-modal-content">
            <h2>Správa projektů</h2>
            
            <div class="projects-list">
                <div class="projects-header">
                    <span>Název projektu</span>
                    <span>Barva</span>
                    <span>Stav</span>
                    <span>Akce</span>
                </div>
                <div id="projects-container">
                    <!-- Projekty se načtou dynamicky -->
                </div>
            </div>
            
            <div class="add-project-section">
                <h3>Přidat nový projekt</h3>
                <form id="add-project-form">
                    <div class="form-row">
                        <input type="text" id="new-project-name" placeholder="Název projektu" required>
                        <input type="color" id="new-project-color" value="#4a90e2" required>
                        <button type="submit" class="btn btn-primary">Přidat</button>
                    </div>
                </form>
            </div>
            
            <div class="modal-buttons">
                <button type="button" id="close-projects-modal" class="btn btn-secondary">Zavřít</button>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>